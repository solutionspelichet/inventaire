<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pelichet ‚Ä¢ Scan ‚Üí Sheets</title>

  <link rel="manifest" href="./manifest.json" />
  <meta name="theme-color" content="#ff7a00" />
  <link rel="icon" href="./assets/pelichet-logo.png" />
  <link rel="stylesheet" href="./style.css" />

  <script src="https://unpkg.com/@zxing/library@0.20.0"></script>
  <script src="https://unpkg.com/@ericblade/quagga2/dist/quagga.min.js"></script>
</head>

<body>
  <header class="app-header">
    <img src="./assets/pelichet-logo.png" alt="Pelichet" class="logo" />
    <h1>Scan ‚Üí Google Sheets</h1>
  </header>

  <main class="container">
    <section class="card">
      <h2>1) Scanner un code</h2>

      <div class="row">
        <button id="btnStart">‚ñ∂Ô∏è Cam√©ra en direct</button>
        <button id="btnStop" disabled>‚èπÔ∏è Stop</button>
        <button id="btnPhoto">üì∏ Scanner via photo</button>
        <input id="photoInput" type="file" accept="image/*" capture="environment" hidden>
      </div>

      <div class="row">
        <select id="cameraSelect"></select>
        <select id="resSelect">
          <option value="1280x720">720p</option>
          <option value="1920x1080" selected>1080p</option>
          <option value="3840x2160">2160p</option>
        </select>
        <select id="engineSelect">
          <option value="auto" selected>Auto</option>
          <option value="native">Natif</option>
          <option value="zxing">ZXing</option>
          <option value="quagga">Quagga</option>
        </select>
      </div>

      <div class="video-wrap" id="videoWrap">
        <video id="preview" autoplay playsinline muted></video>
        <canvas id="overlay"></canvas>
        <div id="diag" class="focus-meter left">‚Äì</div>
      </div>

      <div class="row controls">
        <button id="btnTorch" class="secondary" disabled>Lampe OFF</button>
        <div id="zoomWrap" class="zoom-wrap" hidden>
          <label for="zoomRange">Zoom</label>
          <input id="zoomRange" type="range" min="1" max="3" step="0.1" value="1">
          <span id="zoomValue">1√ó</span>
        </div>
      </div>

      <div class="row">
        <label>Code d√©tect√©</label>
        <input id="codeValue" type="text" placeholder="ou saisie manuelle" />
      </div>
    </section>

    <section class="card">
      <h2>2) D√©tails du mouvement</h2>
      <div class="row">
        <label for="depart">Lieu de d√©part</label>
        <select id="depart"></select>
      </div>
      <div class="row">
        <label for="destination">Lieu de destination</label>
        <select id="destination"></select>
      </div>
      <div class="row">
        <label for="dateMvt">Date du mouvement</label>
        <input id="dateMvt" type="date" />
      </div>
      <div class="row">
        <label for="notes">Notes</label>
        <input id="notes" type="text" placeholder="Observation" />
      </div>
      <div class="row">
        <button id="btnSubmit">Enregistrer</button>
      </div>
      <p id="status" class="status"></p>
    </section>
  </main>

  <footer class="app-footer">¬© Pelichet</footer>

  <script>
    window.APP_CONFIG = {
      API_URL: "https://script.google.com/macros/s/AKfycbx3xXSvHYh40FzislJXiR9knA_B7H5T_awb1fFmzRJTOMzh5_4aUbl6IvRc7-3M8psu/exec"
    };
  </script>
  <script src="./script.js"></script>
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./service-worker.js");
    }
  </script>
</body>
</html>
